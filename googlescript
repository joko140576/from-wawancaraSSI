function doPost(e) {
  const ss = SpreadsheetApp.openById("1mlw70bbYPm87hJwXde7cn9geKdxVEwBqCbAPapwDlWY");
  const sheet = ss.getSheetByName("Sheet1");
  const data = JSON.parse(e.postData.contents);

  // Buat header sekali jika sheet masih kosong
  if (sheet.getLastRow() === 0) {
    sheet.appendRow([
      "Timestamp",
      "Nama Pelamar",
      "Nama Pewawancara",
      "Tanggal Wawancara",
      "Nama COU",
      "Usia",
      "Status Pernikahan ",
      "Pendidikan ",
      "Jurusan",
      "Pengalaman",
      "Catatan Pengalaman",
      "Alamat",
      "Status Rumah",
      "Jarak Rumah",
      "HP Keluarga ",
      "Mengetahui PT SSI ",
      "Punya Referensi",
      "Detail Referensi ",
      "SIM",
      "Nilai Komputer",
      "Bahasa",
      "Software",
      "Jenis Hardware",
      "Hardware",
      "Analisa",
      "Komunikasi",
      "Inisiatif",
      "Etika",
      "Adaptasi",
      "Disiplin",
      "Semangat",
      "Kelebihan",
      "Kekurangan",
      "Kesehatan",
      "Detail Kesehatan",
      "Keputusan",
      "Catatan Penilai",
      "catatan tambahan "
    ]);
  }

  // **Tulis baris sesuai ID input HTML**
  sheet.appendRow([
    new Date(),
    data.nama,
    data.nama_pewawancara,
    data.tanggal_wawancara,
    data.nama_cou,
    data.usia,
    data.status_pernikahan,
    data.pendidikan,
    data.jurusan,
    data.pengalaman,
    data.catatan_pengalaman,
    data.alamat,
    data.status_rumah,
    data.jarak_rumah,
    data.hp_keluarga,
    data.mengetahui_ptssi,
    data.punya_ref,
    data.ref_detail,
    data.sim,
    data.r_komputer,
    data.r_bahasa,
    data.r_software,
    data.jenis_hardware,
    data.r_hardware,
    data.r_analisa,
    data.n_komunikasi,
    data.n_inisiatif,
    data.n_etika,
    data.n_adaptasi,
    data.n_disiplin,
    data.n_semangat,
    data.kelebihan,
    data.kekurangan,
    data.kesehatan,
    data.kesehatan_detail,
    data.keputusan,
    data.catatanBox,
    data.catatan_tambahan

  ]);

  return ContentService.createTextOutput("OK");
}
